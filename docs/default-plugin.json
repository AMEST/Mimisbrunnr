{
  "Id": "550e8400-e25b-41d4-a716-446653440000",
  "PluginIdentifier": "mm.plugin.default",
  "Name": "Default Mimisbrunnr Plugin",
  "Version": "1.0.0-c",
  "Macros": [
    {
      "MacroIdentifier": "mm.plugin.default.anchor",
      "Name": "Anchor",
      "Description": "Create anchors inside the page that can be a hyperlink.",
      "Icon": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHZpZXdCb3g9IjAgMCAyMDQuODUgMjA0Ljg1IiB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4Ij4KICA8cGF0aCBmaWxsPSIjMDEwMDAyIiBkPSJtMTM5LjUyIDEyOC42IDE2LjgzIDE2LjMzcy0yMC42NCAyOS44OC00Mi43MiAzMC40N2MuNDggMCAuMTEtODQuMDkuMDQtMTA0LjQ3IDE0LjY5LTQuOCAyNS40LTE4LjE4IDI1LjQtMzQuMTIgMC0yMC0xNi43LTM2LjIxLTM3LjI3LTM2LjIxLTIwLjYyIDAtMzcuMzIgMTYuMi0zNy4zMiAzNi4yIDAgMTUuNjggMTAuMzggMjguOTMgMjQuNzUgMzMuOTdsLjEgMTA0LjI3Yy0yNi42NC0xLjgzLTQyLjA2LTI3LjQ3LTQyLjA2LTI3LjQ3bDE4LTE3LjQxTDAgMTIwLjVsOS44OSA2My4zIDE3LjM2LTE2Ljc5YzE1LjAzIDEyLjEgMzIuMDIgMzcuMjQgNzIuODggMzcuMjQgNTEuMzMtMS4zIDYzLjE4LTI4LjkzIDc2LjM0LTM5LjhsMTkgMTguNTEgOS4zOC02My45LTY1LjMzIDkuNTN6TTgyLjU2IDM2LjJjMC0xMC4yOSA4LjYtMTguNjUgMTkuMjItMTguNjVzMTkuMjUgOC4zNiAxOS4yNSAxOC42NmMwIDEwLjMyLTguNjQgMTguNjgtMTkuMjUgMTguNjhTODIuNTYgNDYuNTMgODIuNTYgMzYuMnoiLz4KPC9zdmc+Cg==",
      "Params": [
        "name"
      ],
      "DefaultValues": {},
      "Template": "<a name=\"{{#UrlEncode}}{{name}}{{/UrlEncode}}\"></a>",
      "RenderUrl": "",
      "SendUserToken": false,
      "StoreParamsInDatabase": false
    },
    {
      "MacroIdentifier": "mm.plugin.default.attachments",
      "Name": "Attachments list",
      "Description": "Add list with attachments",
      "Icon": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgLTEuODMgNDcgNDciIHdpZHRoPSI2NHB4IiBoZWlnaHQ9IjY0cHgiPgogIDxnIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzIzMWYyMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj4KICAgIDxwYXRoIGQ9Ik0yOC41IDM1LjdILjVWNDBzLjI5IDIuNyAyLjU4IDIuN0gzMi42cy00LjA5LTEuNTQtNC4wOS0zLjU1WiIvPgogICAgPHBhdGggZD0iTTMyLjY1IDQyLjg0czQuODUuMDMgNC44NS03LjE0di0zMVMzOC4zMy42OSA0MS43OC42OUg5LjFzLTMuNiAxLjE0LTMuNiA0LjN2MzAuNyIvPgogICAgPHBhdGggZD0iTTM3LjUgNy43aDlWNC45MlM0Ni4xMS41IDQyIC41TTExLjUgMjMuN2gxOW0tMTkgNGgxOW0tMTktMTJoMTltLTE5LTRoMTltLTE5IDhoMTkiLz4KICA8L2c+Cjwvc3ZnPgo=",
      "Params": [],
      "DefaultValues": {},
      "Template": "<script>\n  fetch(`/api/attachment/{{PageId}}`)\n    .then(response => response.json())\n    .then(attachments => {\n      const listItems = attachments\n        .map(file =>\n          `<li>\n            <a href=\"/api/attachment/{{PageId}}/${file.name}\" target=\"_blank\">\n              ${file.name}\n            </a>\n          </li>`\n        )\n        .join('');\n\n      document.querySelectorAll(`div[id='macro_{{MacroIdOnPage}}']`)\n        .forEach(container => {\n          container.setAttribute('style', 'display: block!important');\n          container.innerHTML = `<ul>${listItems}</ul>`;\n        });\n    });\n</script>\n",
      "RenderUrl": "",
      "SendUserToken": false,
      "StoreParamsInDatabase": false
    },
    {
      "MacroIdentifier": "mm.plugin.default.page-tree",
      "Name": "Page tree",
      "Description": "Adds a list of child pages",
      "Icon": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4Ij4KICA8cGF0aCBkPSJNNDIxLjI5IDEyMS40N1Y2MC43M0gzMDIuODJMMjQyLjA4IDBIMjAuMjh2MzkwLjUzSDkwLjd2NjAuNzRoNzAuNDRWNTEyaDMzMC41N1YxMjEuNDdINDIxLjN6bS0xNzAuMy02OS41NSA4LjgxIDguODFMMjg0LjA1IDg1bDE0Ljg3IDE0Ljg3SDI1MVY1MS45MnpNNTAuNyAzNjAuMTNWMzAuNDJoMTY5Ljg4djk5Ljg2aDk5Ljg2djIyOS44NEg1MC43em03MC40NCA2MC43M3YtMzAuMzJoMjI5LjcyVjEwOC43N2wtMTcuNjItMTcuNjJoNTcuNjR2MzI5LjdIMTIxLjEzem0zNDAuMTcgNjAuNzNIMTkxLjU3di0zMC4zMWgyMjkuNzJWMTUxLjg5aDQwLjAxdjMyOS43eiIvPgo8L3N2Zz4K",
      "Params": [],
      "DefaultValues": {},
      "Template": "<script>\n  const containers = document.querySelectorAll(`div[id='macro_{{MacroIdOnPage}}']`);\n  if (!containers) return;\n\n  function renderTree(data) {\n    if (!data || !data.childs || !data.childs.length) return '';\n\n    let ul = document.createElement('ul');\n    ul.style.listStyleType = 'none';\n    ul.style.paddingLeft = '20px';\n\n    data.childs.forEach(item => {\n      let li = document.createElement('li');\n      let a = document.createElement('a');\n      a.href = `/space/${item.page.spaceKey}/${item.page.id}`;\n      a.textContent = item.page.name;\n      a.style.display = 'block';\n      a.style.padding = '4px 0';\n      li.appendChild(a);\n\n      if (item.childs && item.childs.length) {\n        let childUl = renderTree(item);\n        if (childUl) li.appendChild(childUl);\n      }\n\n      ul.appendChild(li);\n    });\n\n    return ul;\n  }\n\n  fetch(\"/api/page/{{PageId}}/tree\")\n    .then(response => response.json())\n    .then(data => {\n      containers.forEach( container => {\n          container.innerHTML = '';\n          container.appendChild(renderTree(data));\n          container.setAttribute(`style`,`display: block!important`);\n      });\n    })\n    .catch(error => {\n      containers.forEach(x => x.innerHTML = `<div style='color: red;'>Error loading page tree: ${error.message}</div>`);\n    });\n</script>",
      "RenderUrl": "",
      "SendUserToken": false,
      "StoreParamsInDatabase": false
    },
    {
      "MacroIdentifier": "mm.plugin.default.table-filter",
      "Name": "Table filter",
      "Description": "Adding filtering and sorting to tables on a page",
      "Icon": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjY0cHgiIGhlaWdodD0iNjRweCI+CiAgPHBhdGggc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTIxIDZoLTJtMiA2aC01bTUgNmgtNW0tOSAydi02LjQ0YzAtLjIgMC0uMzEtLjAyLS40MWExIDEgMCAwIDAtLjA5LS4yNWMtLjA1LS4xLS4xMS0uMTgtLjI0LS4zNGwtMy4zLTQuMTJjLS4xMy0uMTYtLjItLjI1LS4yNC0uMzRhMSAxIDAgMCAxLS4wOS0uMjVDMyA3Ljc1IDMgNy42NSAzIDcuNDRWNS42YzAtLjU2IDAtLjg0LjEtMS4wNWExIDEgMCAwIDEgLjQ1LS40NEMzLjc2IDQgNC4wNCA0IDQuNiA0aDguOGMuNTYgMCAuODQgMCAxLjA1LjFhMSAxIDAgMCAxIC40NC40NWMuMTEuMjEuMTEuNDkuMTEgMS4wNXYxLjg0YzAgLjIgMCAuMzEtLjAyLjQxYTEgMSAwIDAgMS0uMDkuMjVjLS4wNS4xLS4xMS4xOC0uMjQuMzRsLTMuMyA0LjEyYy0uMTMuMTYtLjIuMjUtLjI0LjM0YTEgMSAwIDAgMC0uMDkuMjVjLS4wMi4xLS4wMi4yLS4wMi40MVYxN2wtNCAzWiIvPgo8L3N2Zz4K",
      "Params": [],
      "DefaultValues": {},
      "Template": "<style>\n    .table-container {\n        margin: 20px 0;\n    }\n    \n    .search-input {\n        padding: 8px;\n        margin-bottom: 10px;\n        width: 300px;\n        border: 1px solid #ddd;\n        border-radius: 4px;\n    }\n    \n    table {\n        width: 100%;\n        border-collapse: collapse;\n    }\n    \n    th, td {\n        padding: 8px;\n        text-align: left;\n        border: 1px solid #ddd;\n    }\n    \n    th {\n        background-color: #f2f2f2;\n        cursor: pointer;\n        position: relative;\n    }\n    \n    th:hover {\n        background-color: #e6e6e6;\n    }\n    \n    th::after {\n        content: '↕';\n        position: absolute;\n        right: 8px;\n        opacity: 0.3;\n    }\n    \n    th.asc::after {\n        content: '↑';\n        opacity: 1;\n    }\n    \n    th.desc::after {\n        content: '↓';\n        opacity: 1;\n    }\n    \n    .no-results {\n        padding: 20px;\n        text-align: center;\n        color: #666;\n        font-style: italic;\n    }\n</style>\n<script>\nconst tables = document.querySelectorAll('table');\ntables.forEach(table => {\n    const container = document.createElement('div');\n    container.className = 'table-container';\n    table.parentNode.insertBefore(container, table);\n    container.appendChild(table);\n    \n    const searchInput = document.createElement('input');\n    searchInput.type = 'text';\n    searchInput.placeholder = 'Search in table...';\n    searchInput.className = 'search-input';\n    container.insertBefore(searchInput, table);\n    \n    const thead = table.querySelector('thead');\n    const tbody = table.querySelector('tbody');\n    const headers = thead.querySelectorAll('th');\n    const rows = Array.from(tbody.querySelectorAll('tr'));\n    \n    headers.forEach((header, columnIndex) => {\n        header.addEventListener('click', () => {\n            sortTable(columnIndex);\n        });\n    });\n    \n    function sortTable(columnIndex) {\n        const isNumeric = rows.every(row => {\n            const cell = row.cells[columnIndex];\n            return !isNaN(parseFloat(cell.textContent)) && isFinite(cell.textContent);\n        });\n        \n        const currentDir = headers[columnIndex].classList.contains('asc') ? 'asc' : \n                            headers[columnIndex].classList.contains('desc') ? 'desc' : 'none';\n        \n        headers.forEach(header => {\n            header.classList.remove('asc', 'desc');\n        });\n        \n        rows.sort((a, b) => {\n            const aValue = a.cells[columnIndex].textContent.trim();\n            const bValue = b.cells[columnIndex].textContent.trim();\n            \n            let comparison = isNumeric \n                ? parseFloat(aValue) - parseFloat(bValue)\n                : aValue.localeCompare(bValue, 'ru');\n            \n            return currentDir === 'asc' ? -comparison : comparison;\n        });\n        \n        headers[columnIndex].classList.add(currentDir === 'asc' ? 'desc' : 'asc');\n        \n        tbody.innerHTML = '';\n        rows.forEach(row => tbody.appendChild(row));\n\n        applyFilter();\n    }\n    \n    function applyFilter() {\n        const searchText = searchInput.value.toLowerCase();\n        \n        rows.forEach(row => {\n            let rowText = '';\n            Array.from(row.cells).forEach(cell => {\n                rowText += cell.textContent.toLowerCase() + ' ';\n            });\n            row.style.display = rowText.includes(searchText) ? '' : 'none';\n        });\n        \n        const visibleRows = rows.filter(row => row.style.display !== 'none');\n        if (visibleRows.length === 0 && searchText) {\n            if (!tbody.querySelector('.no-results')) {\n                const noResults = document.createElement('tr');\n                noResults.className = 'no-results';\n                noResults.innerHTML = `<td colspan=\"${headers.length}\">No results</td>`;\n                tbody.appendChild(noResults);\n            }\n        } else {\n            const noResults = tbody.querySelector('.no-results');\n            if (noResults)\n                tbody.removeChild(noResults);\n        }\n    }\n    searchInput.addEventListener('input', applyFilter);\n    applyFilter();\n});\n</script>",
      "RenderUrl": "",
      "SendUserToken": false,
      "StoreParamsInDatabase": false
    },
    {
      "MacroIdentifier": "mm.plugin.default.numbered-headings",
      "Name": "Numbered Headings",
      "Description": "Add level numbers before headings",
      "Icon": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHZpZXdCb3g9IjAgMCA5NC41IDk0LjUiPgogIDxwYXRoIGQ9Ik05Mi41IDYuOEgyNi44YTIgMiAwIDAgMC0yIDJ2MTAuOGMwIDEgMSAyIDIgMmg2NS43YTIgMiAwIDAgMCAyLTJWOC44YTIgMiAwIDAgMC0yLTJ6bTAgMzMuN0gyNi44YTIgMiAwIDAgMC0yIDJ2MTAuN2MwIDEuMSAxIDIgMiAyaDY1LjdhMiAyIDAgMCAwIDItMlY0Mi41YTIgMiAwIDAgMC0yLTJ6bTAgMzQuNkgyNi44YTIgMiAwIDAgMC0yIDJWODhjMCAxIDEgMiAyIDJoNjUuN2EyIDIgMCAwIDAgMi0yVjc3YTIgMiAwIDAgMC0yLTJ6bS05MC43LTY0Yy41IDAgLjkgMCAxLjItLjRsMS0uOHYxM2MwIC44LjYgMS41IDEuNCAxLjVIN2MuOCAwIDEuNS0uNyAxLjUtMS41VjUuNkM4LjUgNC43IDcuOCA0IDcgNEg1LjRjLS40IDAtLjcgMC0xIC4zTC41IDcuN2MtLjYuNS0uNyAxLjQtLjIgMmwuNS44Yy4yLjMuNi42IDEgLjZ6bS43IDI2LjRjLS42LjItMSAuOS0xIDEuNmwuMiAxYTEuNSAxLjUgMCAwIDAgMi4xIDEuMWMxLjItLjYgMi0uNyAzLS41QTIgMiAwIDAgMSA4LjIgNDJjLjQgMS4yLjQgMy0yLjkgN2wtMi41IDIuOWMtLjUuNy0xIDEuMS0xLjMgMS40LS4zLjMtLjUuNy0uNSAxLjF2MS41YzAgLjguNyAxLjUgMS41IDEuNWg5LjJjLjggMCAxLjUtLjcgMS41LTEuNVY1NWMwLS44LS43LTEuNS0xLjUtMS41SDYuOWwxLjctMmMyLjgtMy41IDUtNi43IDQuMy0xMC40LS4zLTEuNy0xLjItMy0yLjctMy44YTggOCAwIDAgMC0zLjItLjZjLTEuNCAwLTMgLjMtNC41Ljh6bTggNDIgLjctLjVhNC44IDQuOCAwIDAgMCAxLjgtMy45YzAtMS44LS43LTMuMy0yLjEtNC40YTggOCAwIDAgMC00LjQtMS4xYy0xLjQgMC0yLjguMi00IC42LS43LjItMS4yLjgtMS4xIDEuNXYuOWExLjUgMS41IDAgMCAwIDIgMS4zYy45LS4zIDEuNi0uNSAyLjMtLjVsLjcuMWMxIC4xIDEuNS42IDEuOSAxLjMuMi41LjIgMS40LS4xIDEuOS0uNyAxLTIuNCAxLjItMy41IDEuMi0uOCAwLTEuNC43LTEuNCAxLjV2LjdjMCAuOC43IDEuNSAxLjUgMS41IDEuNiAwIDIuMy4zIDIuNi41LjcuNCAxIDEgMSAxLjkuMS45LS4zIDEuNi0xIDIuMS0xIC43LTIuNy43LTQuNiAwYTEuNSAxLjUgMCAwIDAtMiAxLjN2MWMwIC42LjMgMS4yIDEgMS40LjMuMi41LjIgMSAuMy44LjIgMS44LjMgMi44LjMgMS41IDAgNC4zLS4yIDYtMiAxLjYtMS42IDItNCAxLjUtNS42LS41LTIuMS0xLjYtMi45LTIuNi0zLjN6Ii8+Cjwvc3ZnPgo=",
      "Params": [],
      "DefaultValues": {},
      "Template": "<style>\n.numbered::before {\n    content: attr(data-number) \" \";\n    color: rgba(0, 0, 0, 0.1);\n    font-weight: bold;\n    margin-right: 5px;\n}\n.toc-anchor {\n    display: none!important;\n}\n</style>\n<script>\nconst container = document.getElementById('page-content');\nif (container){\n    const headings = container.querySelectorAll('h1, h2, h3, h4, h5, h6');\n    const counters = new Array(6).fill(0);\n    let lastProcessedLevel = -1;\n\n    headings.forEach(heading => {\n        const currentLevel = parseInt(heading.tagName.substring(1)) - 1;\n        if (lastProcessedLevel === -1) {\n            counters[currentLevel] = 1;\n        } else if (currentLevel > lastProcessedLevel) {\n            counters[currentLevel]++;\n        } else if (currentLevel === lastProcessedLevel) {\n            counters[currentLevel]++;\n        } else {\n            counters[currentLevel]++;\n            for (let i = currentLevel + 1; i < 6; i++)\n                counters[i] = 0;\n        }\n        const numberParts = [];\n        for (let i = 0; i <= currentLevel; i++)\n            if (counters[i] > 0)\n                numberParts.push(counters[i]);\n        \n        const number = numberParts.join('.');\n        heading.setAttribute('data-number', number);\n        heading.classList.add('numbered');\n        \n        lastProcessedLevel = currentLevel;\n    });\n}\n</script>",
      "RenderUrl": "",
      "SendUserToken": false,
      "StoreParamsInDatabase": false
    },
    {
      "MacroIdentifier": "mm.plugin.default.user-card",
      "Name": "User card",
      "Description": "User card with info",
      "Icon": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgd2lkdGg9IjY0cHgiPgogIDxwYXRoIGZpbGw9IiM0NDQiIGQ9Ik0xNSAzdjEwSDFWM2gxNHptMS0xSDB2MTJoMTZWMnoiLz4KICA8cGF0aCBmaWxsPSIjNDQ0IiBkPSJNOCA1aDZ2MUg4VjV6bTAgMmg2djFIOFY3em0wIDJoM3YxSDhWOXpNNS40IDdINXYtLjFjLjYtLjIgMS0uOCAxLTEuNEM2IDQuNyA1LjMgNCA0LjUgNFMzIDQuNyAzIDUuNWMwIC43LjQgMS4yIDEgMS40VjdoLS40QzIuNyA3IDIgNy43IDIgOC42VjExaDVWOC42QzcgNy43IDYuMyA3IDUuNCA3eiIvPgo8L3N2Zz4K",
      "Params": [
        "email"
      ],
      "DefaultValues": {},
      "Template": "<div class=\"user-card-container\" id=\"user-card-{{MacroIdOnPage}}\">\n  <div class=\"card\" style=\"width: 13rem;\">\n    <div class=\"card-body text-center\">\n      <div class=\"user-content\">\n        <div class=\"spinner-border text-primary\" role=\"status\">\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<script>\n  const email = '{{email}}'.trim();\n  const uniqueId = '{{MacroIdOnPage}}';\n  const container = document.querySelector('#user-card-' + uniqueId + ' .user-content');\n  \n  if (!email) {\n    container.innerHTML = '<p class=\"text-danger\">Email is empty</p>';\n    return;\n  }\n\n  function escapeHtml(unsafe) {\n    if (!unsafe) return '';\n    return unsafe\n      .toString()\n      .replace(/&/g, \"&amp;\")\n      .replace(/</g, \"&lt;\")\n      .replace(/>/g, \"&gt;\")\n      .replace(/\"/g, \"&quot;\")\n      .replace(/'/g, \"&#039;\");\n  }\n  function shouldDisplayField(value) {\n    return value !== null && value !== undefined && value !== '' && value !== 'null' && value !== 'undefined';\n  }\n  function createOptionalField(icon, value, title = '') {\n    if (!shouldDisplayField(value)) return '';\n    \n    return `\n      <div class=\"user-field\" title=\"${escapeHtml(title)}\">\n        ${icon}\n        <span class=\"text-muted small\">${escapeHtml(value)}</span>\n      </div>\n    `;\n  }\n  fetch('/api/user/' + encodeURIComponent(email), {\n    headers: {\n      'Accept': 'application/json',\n    },\n    credentials: 'same-origin'\n  })\n  .then(response => {\n    if (response.ok) {\n      return response.json();\n    }\n    throw new Error('HTTP ' + response.status);\n  })\n  .then(userData => {\n    const safeEmail = escapeHtml(userData.email || email);\n    const safeName = escapeHtml(userData.name);\n    const avatarUrl = userData.avatarUrl || 'https://via.placeholder.com/80';\n\n    const optionalFields = [\n      createOptionalField('💼', userData.post, 'Post'),\n      createOptionalField('📍', userData.location, 'Location'),\n      createOptionalField('🏢', userData.organization, 'Organization')\n    ].filter(field => field !== '').join('');\n    \n    container.innerHTML = `\n      <img src=\"${escapeHtml(avatarUrl)}\" \n           class=\"rounded-circle mb-3\" \n           alt=\"Аватар пользователя\" \n           width=\"80\" \n           height=\"80\"\n           onerror=\"this.src='https://via.placeholder.com/80'\">\n      <h5 class=\"card-title mb-2\">${safeName || 'Без имени'}</h5>\n      <p class=\"card-text text-muted mb-3\">${safeEmail}</p>\n      \n      ${optionalFields ? `<div class=\"optional-fields mb-3\">${optionalFields}</div>` : ''}\n      \n      <div class=\"d-grid gap-2\">\n        <a href=\"mailto:${safeEmail}\" class=\"btn btn-primary btn-sm\">\n          <i class=\"bi bi-envelope\"></i> Написать\n        </a>\n      </div>\n    `;\n  })\n  .catch(error => {\n    console.warn('User data loading failed:', error);\n    container.innerHTML = `\n      <p class=\"text-muted\">@unknown(${escapeHtml(email)})</p>\n    `;\n  });\n</script>\n\n<style>\n.user-card-container .card {\n  margin: 10px 0;\n  border: 1px solid #e9ecef;\n  border-radius: 0.5rem;\n}\n.user-card-container .card-body {\n  padding: 1.5rem;\n}\n.user-card-container .optional-fields {\n  border-top: 1px solid #f1f3f4;\n  padding-top: 1rem;\n  margin-top: 0.5rem;\n}\n.user-card-container .user-field {\n  margin-bottom: 0.5rem;\n  line-height: 1.3;\n}\n.user-card-container .user-field:last-child {\n  margin-bottom: 0;\n}\n.user-card-container .user-field i {\n  color: #6c757d;\n  width: 16px;\n}\n.user-card-container .text-muted.small {\n  font-size: 0.875rem;\n}\n</style>",
      "RenderUrl": "",
      "SendUserToken": false,
      "StoreParamsInDatabase": true
    },
    {
      "MacroIdentifier": "mm.plugin.default.simple-mention",
      "Name": "Simple mention",
      "Description": "Simple user mention macro",
      "Icon": "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbDpzcGFjZT0icHJlc2VydmUiIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiB3aWR0aD0iNjRweCIgaGVpZ2h0PSI2NHB4Ij4KICA8cGF0aCBkPSJNNDIxLjI5IDEyMS40N1Y2MC43M0gzMDIuODJMMjQyLjA4IDBIMjAuMjh2MzkwLjUzSDkwLjd2NjAuNzRoNzAuNDRWNTEyaDMzMC41N1YxMjEuNDdINDIxLjN6bS0xNzAuMy02OS41NSA4LjgxIDguODFMMjg0LjA1IDg1bDE0Ljg3IDE0Ljg3SDI1MVY1MS45MnpNNTAuNyAzNjAuMTNWMzAuNDJoMTY5Ljg4djk5Ljg2aDk5Ljg2djIyOS44NEg1MC43em03MC40NCA2MC43M3YtMzAuMzJoMjI5LjcyVjEwOC43N2wtMTcuNjItMTcuNjJoNTcuNjR2MzI5LjdIMTIxLjEzem0zNDAuMTcgNjAuNzNIMTkxLjU3di0zMC4zMWgyMjkuNzJWMTUxLjg5aDQwLjAxdjMyOS43eiIvPgo8L3N2Zz4K",
      "Params": [
        "email"
      ],
      "DefaultValues": {},
      "Template": "<span id=\"mention-{{MacroIdOnPage}}\">@...</span>\n\n<script>\n  const email = '{{email}}'.trim();\n  const uniqueId = '{{MacroIdOnPage}}';\n  const element = document.getElementById('mention-' + uniqueId);\n  \n  if (!email) {\n    element.innerHTML = '<span style=\"color: #dc3545; font-weight: 500;\">Email is empty</span>';\n    return;\n  }\n\n  fetch('/api/user/' + encodeURIComponent(email))\n    .then(response => response.status === 200 ? response.json() : Promise.reject())\n    .then(userData => {\n      const name = userData?.name || email;\n      element.innerHTML = `<a href=\"/profile/${email}\" style=\"color: #0d6efd; background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 2px 6px; font-weight: 500;\">@${name}</a>`;\n    })\n    .catch(() => {\n      element.innerHTML = `<span style=\"color: #6c757d; font-style: italic;\">@unknown(${email})</span>`;\n    });\n</script>",
      "RenderUrl": "",
      "SendUserToken": false,
      "StoreParamsInDatabase": false
    }
  ]
}